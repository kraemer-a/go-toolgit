<!DOCTYPE html>
<html>
<head>
    <title>Wails Test</title>
</head>
<body>
    <h1>Wails Binding Test</h1>
    <button id="test-greet">Test Greet</button>
    <button id="test-config">Test UpdateConfig</button>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        function log(msg) {
            output.innerHTML += `<div>${new Date().toISOString()}: ${msg}</div>`;
            console.log(msg);
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            log('DOM loaded');
            log('window.go available: ' + (window.go !== undefined));
            
            if (window.go) {
                log('window.go keys: ' + Object.keys(window.go).join(', '));
                
                if (window.go.gui) {
                    log('window.go.gui keys: ' + Object.keys(window.go.gui).join(', '));
                    
                    if (window.go.gui.App) {
                        log('window.go.gui.App keys: ' + Object.keys(window.go.gui.App).join(', '));
                    }
                }
            }
            
            document.getElementById('test-greet').addEventListener('click', async () => {
                log('Testing Greet...');
                try {
                    if (window.go?.gui?.App?.Greet) {
                        const result = await window.go.gui.App.Greet('World');
                        log('Greet result: ' + result);
                    } else {
                        log('Greet method not found');
                    }
                } catch (err) {
                    log('Greet error: ' + err);
                }
            });
            
            document.getElementById('test-config').addEventListener('click', async () => {
                log('Testing UpdateConfig...');
                try {
                    if (window.go?.gui?.App?.UpdateConfig) {
                        const config = {
                            provider: 'github',
                            github_url: 'https://api.github.com',
                            token: 'test-token'
                        };
                        await window.go.gui.App.UpdateConfig(config);
                        log('UpdateConfig succeeded');
                    } else {
                        log('UpdateConfig method not found');
                    }
                } catch (err) {
                    log('UpdateConfig error: ' + err);
                }
            });
        });
    </script>
</body>
</html>